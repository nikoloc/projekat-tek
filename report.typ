#set text(
  size: 12pt,
  lang: "sr",
)

#show link: it => underline(offset: 2pt, text(fill: blue, it))

#show heading: it => block(
  above: 1.8em,
  below: 1.2em,
  it,
)

#show figure: it => block(
  below: 1.8em,
  it,
)

#show figure.where(kind: table): it => {
  v(1.8em)
  it.caption
  it.body
}

#set page(numbering: "1")
#set heading(numbering: "1.")
#set math.equation(numbering: "(1)")

#place(
  top + left,
  dx: -5pt,
  image("assets/etf.jpg", width: 50%),
)

#v(1fr)

#align(center)[
  #align(left
  )[
    #text(
      size: 12pt,
      fill: rgb(85, 85, 85),
    )[
      Студентски пројекат из предмета \
      Теорија електричних кола \
      2025/2026
    ]

    #v(0.5em)

    #text(
      size: 24pt,
      weight: "bold",
    )[
      Инвертујући појачавач, \
      филтер ниских фреквенција
    ]

    #v(0.5em)

    #text(
      size: 12pt,
    )[
      Тим 19
    ]

    #text(
      size: 12pt,
    )[
      Студенти: Јаков Павловић 24/0223, Дарко Николић 24/0047\
      Наставник: др Никола Баста, доцент
    ]
  ]

  #v(1em)
]

#v(1fr)

#pagebreak()

#outline()

#pagebreak()

= Задатак
Задатак је анализирати, саставити и измерити одзив следећег кола.
#figure(
  image("assets/circuit.svg"),
  caption: [Шема електричног кола],
)

Ово коло представља појачавачки инвертујући филтер ниских фреквенција@TI. У даљем раду ћемо одредити на који начин се подешавањем
његових параметара може добити жељени ефекат.

= Прорачун
За потребе прорачуна подразумеваћемо да је операциони појачавач идеалан. У реалности операциони појачавач ће бити напајан спољашњим
напајањем. О томе шта ово значи за наш појачавач биће више речи у одељку о симулацији кола.

Дато коло ћемо анализирати за простопериодични улазни напонски сигнал $V_"in"=A sin(omega t + phi)$. Како је коло релативно ниске
комплексности решићемо га ручно, у комплексном домену.

Желимо да изразимо излазни напон $underline(V_"out")$ преко улазног напона $underline(V_"in")$ и параметара кола $R_1$, $R_2$ и $C$.

Заменићемо паралелну везу отпорника $R_2$ и кондензатора $C$ еквивалентном импедансом $Z$ вредности

$ underline(Z) = (R_2 dot 1 / (j omega C)) / (R_2 + 1 / (j omega C)) = R_2 / (1 + j omega R_2 C) $

као на слици @fig-transformed-notated-circuit.

#figure(
  image("assets/transformed.svg"),
  caption: [Трансформисано електрично коло],
) <fig-transformed-notated-circuit>

Сада је струја кроз $R_1$ и $Z$ једнака. Означимо је са $I$. Приметимо ли још да је чвор кола који одговара инвертујућем терминалу
идеалног операционог појачавача једнак нули, можемо израчунати струју $I$ примењујући КЗН као

$ underline(I) = underline(V_"in") / R_1 $

Сада лако проналазимо излазни напон $V_"out"$ као

$ underline(V_"out") &= - underline(Z) underline(I)
&= - R_2 / (1 + j omega R_2 C) dot underline(V_"in") / R_1
&= - R_2 / R_1 dot 1 / (1 + j omega R_2 C) dot underline(V_"in") $ 

Овај резултат можемо представити и у облику преносне функције $H(omega)$

$ underline(H)(omega) = underline(V_"out") / underline(V_"in") = - R_2 / R_1 dot 1 / (1 + j omega R_2 C) $ <eq-h>

Односно за ефективне вредности можемо писати

$ H(omega) = R_2 / R_1 dot 1 / sqrt(1 + (omega R_2 C)^2) $

Јасно је да се максимално појачање добија када $omega -> 0$ и одређено је односом вредности отпорника

$ A = - R_2 / R_1 $

Други члан у овом изразу

$ 1 / sqrt(1 + (omega R_2 C)^2) $

нам је интересантнији из перспективе филтрирајућег дела овог кола. Њега можемо учинити врло слабо зависним од $omega$ за мале вредности
$omega$ узимајући кондензатор $C$ вредности реда nF и отпорник $R_2$ реда k#sym.Omega, јер је онда њихов производ реда $"~"10^(-6)$.

Овиме смо показали да се погодним избором параметара у колу може диктирати појачање и истовремено постићи жељени ефекат филтрирања
ниских фреквенција.

График преносне функције $H(omega)$ дат је на слици @fig-calculated, за вредности параметара $R_1 = 1$ k#sym.Omega, $R_2 = 20$
k#sym.Omega и $C = 4 "nF"$ Приметимо да се појачање од 20 пута одржава на снази у јако великом опсегу фреквенција, све до наглог пада
негде након $10^3$ Hz. Ово је управо понашање које смо желели да постигнемо!

#figure(
  image("dest/calculated.png"),
  caption: [График зависности преносне функције од фреквенције сигнала у логаритамској скали за $R_1 = 1$ k#sym.Omega, $R_2 = 20$
k#sym.Omega и $C = 3.9 "nF"$],
) <fig-calculated>

Карактеристично је да се појачања изражавају у децибелима, као

$ G = 10 log(P_"out"/P_"in") $

где су $P_"in"$ i $P_"out"$ снаге улазног, осносно излазног сигнала. Како су снаге пропорционалне квадратима одговарајућих напона,
то можемо писати

$ G = 10 log(V_"out"^2 / V_"in"^2) = 20 log(V_"out" / V_"in") = 20 log H(omega) $

Изражено у децибелима, максимално појачање из претходног примера износи $20 log_10 (20) approx 26$ dB.

Дефинишемо граничну фреквенцију филтера $f_"cutoff"$ као ону фреквенцију при којој је појачање снаге сигнала једнако половини
максималног појачања, а како је снага пропорционална квадрату напона, то је:

$ H(2 pi f_"cutoff") &= 1/sqrt(2)H(0) $
$ 1 / sqrt(1 + (2 pi f_"cutoff" R_2 C)^2) &= 1 / sqrt(2) $
$ => f_"cutoff" = 1 / (2 pi R_2 C) $

За претходно поменуте вредности $R_1 = 1$ k#sym.Omega, $R_2 = 20$ k#sym.Omega и $C = 3.9$ nF добија се гранична фреквенција

$ f_"cutoff" = 1 / (2 pi dot 20 "k"#sym.Omega dot 3.9 "nF") approx 2 "kHz" $

// што одговара очитавању са графика @fig-calculated.

Такође, на основу једначине @eq-h, видимо да преносна функција садржи негативан предзнак. Ово указује на то да је коло конфигурисано као
инвертујући појачавач, што у фазном домену одговара померају од $180°$ за ниске фреквенције. Са порастом фреквенције, присуство
кондензатора $C$ у грани повратне спреге додатно мења фазну разлику како се приближавамо граничној вредности.


= Симулација

За симулацију кола коришћен је програм LTSpice@LTSpice. Увезен је модел TL072 са странице произвођача@TL072.

У програму је исцртана шема (Слика 5) према задатим параметрима:
- Коришћен је модел операционог појачавача TL072.
- Напајање појачавача је изведено са симметричних $+2.5 V$ и $-2.5 V$.
- Вредности пасивних компоненти су постављене на $R_1 = 1$ k#sym.Omega, $R_2 = 20$ k#sym.Omega и $C = 3.9$ nF.
- Извршена је AC Analysis са децималном поделом (100 тачака по декади) у опсегу фреквенција од $1$Hz до $1$MHz.

#figure(
  image("assets-old/lt-spice-circuit.png"),
  caption: [Шема електричног кола симулираног у програму LTSpice],
)

Симулација у LTSpice софтверу је у потпуности потврдила наше прорачуне. Погледајмо кључне аспекте:

- Појачање: На ниским фреквенцијама добили смо појачање од тачно 20 пута ($26$ dB). То нам говори да модел појачавача TL072 ради стабилно и да на ниским учестаностима отпорници $R_1$ и $R_2$ диктирају све.
- Гранична фреквенција: Помоћу курсора смо измерили пад од $-3$ dB на учестаности од $1.995$ kHz. Ово се скоро савршено поклапа са нашом теоријском вредношћу од око $2$ kHz. После ове тачке, појачање нагло опада, што је управо оно што желимо од филтера ниских фреквенција.
- Фаза: На самој граничној фреквенцији фаза износи око $135°$. То је логично, јер појачавач окреће фазу за $180°$, а кондензатор у повратну спрегу додаје кашњење од још $-45°$.

Укратко, симулација је доказала да коло у реалним условима (са правим компонентама попут TL072) ради баш онако како смо замислили на папиру.

#figure(
  image("assets-old/lt-spice-graph.png"),
  caption: [Појачање добијено симулацијом],
)

#figure(
  image("assets-old/lt-spice-cutoff.png"),
  caption: [Очитане вредности на граничној фреквенцији помоћу курсора],
)

= Мерење

* TODO: у договору са професором направити одговарајуће табеле за резултате, приложити слике мерења и прокоментарисати резултате *

#figure(
  table(
    columns: (auto, auto),
    inset: 10pt,
    align: horizon,
    table.header(
      [Volume], [Parameters],
    ),
    $ pi h (D^2 - d^2) / 4 $,
    [
      $h$: height
      $D$: outer radius
      $d$: inner radius
    ],
    $ sqrt(2) / 12 a^3 $,
    [$a$: edge length]
  ),
  caption: "Пример табеле",
)
#pagebreak()

#bibliography("reference.bib", style: "ieee", title: "Референце")

